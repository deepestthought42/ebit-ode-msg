syntax = "proto3";

package EbitODE;


/* structure to map, one-to-one, nuclides with mass A, proton number Z and charge state q
 * onto an index i: {A,Z,q} -> i */

message Index {
    int32 A = 1; // mass number
    int32 Z = 2; // proton number
    int32 q = 3; // charge state
    int32 i = 4; // index
}

/* structure to describe Rate constants */

message Rate {
    double RateInHz  = 1; // Rate in Hz
    string Description = 2; 
    Index origin = 3; // index of origin of change 
    Index destination = 4; // index of destination of changeq
}


/* a list of rates */

message RateList {
    repeated Rate rates = 1;
    int32 dimension = 2;
}



/* Service definitions */

enum Status {
    Idle = 0;
    SolivingODE = 1;
}

message Update {
    Status status = 1;
    string Message = 2;
}


enum ProblemType {
    ODEProblem = 0;
}


message ProblemConfiguration {
}


message TimeSpan {
    double start = 1;
    double stop = 2;
}

message Problem {
    ProblemType problem_type = 1;
    TimeSpan time_span = 2;
    RateList rate_list = 3;
    repeated double initial_values = 4;
    repeated double saveat = 5;
    ProblemConfiguration config = 6;
    repeated Index indices = 7;
}


message ValuesPerIndex {
    Index index = 1;
    repeated double values = 2;
}


enum ReturnCode {
    Default = 0;
    Success = 1;
    MaxIters = 2;
    DtLessThanMin = 3;
    Unstable = 4;
    InitialFailure = 5;
    ConvergenceFailure = 6;
    Failure = 7;
}


message Result {
    Problem problem = 1;
    ReturnCode return_code = 2;
    double start_time = 3;
    double stop_time = 4;
    repeated double times = 5;
    repeated ValuesPerIndex values = 6;
}


